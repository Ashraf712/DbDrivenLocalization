@* @model IReadOnlyList<DbDrivenLocalization.Models.AppLanguage>

@{
    var current = System.Globalization.CultureInfo.CurrentUICulture.Name;
    var returnUrl = Context.Request.Path + Context.Request.QueryString;
}

<form action="/culture/set" method="get" class="d-inline">
    <input type="hidden" name="returnUrl" value="@returnUrl" />
    <select name="c" onchange="this.form.submit()">
        @foreach (var l in Model)
        {
            <option value="@l.Culture" selected="@(l.Culture.Equals(current, StringComparison.OrdinalIgnoreCase))">
                @l.Name (@l.Culture)
            </option>
        }
    </select>
</form>
 *@

@using System.Globalization
@model IReadOnlyList<DbDrivenLocalization.Models.AppLanguage>

@{
    var current = CultureInfo.CurrentUICulture.Name;
    var returnUrl = Context.Request.Path + Context.Request.QueryString;

    var currentLang = Model.FirstOrDefault(x => x.Culture.Equals(current, StringComparison.OrdinalIgnoreCase))
                      ?? Model.FirstOrDefault();

    var label = currentLang is null ? current : $"{currentLang.Name} ({currentLang.Culture})";
}

<div class="dropdown">
    <button class="btn btn-sm btn-outline-light dropdown-toggle w-100 w-sm-auto"
            type="button"
            data-bs-toggle="dropdown"
            aria-expanded="false">
        🌐 @label
    </button>

    <ul class="dropdown-menu dropdown-menu-end shadow">
        @foreach (var l in Model)
        {
            var active = l.Culture.Equals(current, StringComparison.OrdinalIgnoreCase);
            <li>
                <a class="dropdown-item d-flex align-items-center justify-content-between @(active ? "active" : "")"
                   href="/culture/set?c=@l.Culture&returnUrl=@Uri.EscapeDataString(returnUrl)">
                    <span>@l.Name</span>
                    <span class="text-muted small">@l.Culture</span>
                </a>
            </li>
        }
    </ul>
</div>
